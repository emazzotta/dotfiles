#!/bin/bash

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
source "$SCRIPT_DIR/shelllog.sh"

PATTERNS=(
  "ACCFinderSync"
  "Adobe Crash Processor"
  "Adobe Desktop Service"
  "AdobeIPCBroker"
  "CCXProcess"
  "Core Sync"
  "Creative Cloud Helper"
  "Microsoft AutoUpdate"
  "Microsoft Update Assistant"
  "com.microsoft.autoupdate.helper"
)

for pattern in "${PATTERNS[@]}"; do
  pids=$(pgrep -f "$pattern")
  if [[ -n "$pids" ]]; then
    log "Killing processes matching: $pattern"
    echo "$pids" | xargs kill -9
  fi
done

UPDATE_APP="/Library/Application Support/Microsoft/MAU2.0/Microsoft AutoUpdate.app/Contents/MacOS/Microsoft Update Assistant.app"
if [ -e "$UPDATE_APP"  ]; then
        sudo mv "$UPDATE_APP" "$UPDATE_APP.disabled"
fi

success "Done killing unwanted processes."
