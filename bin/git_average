#!/bin/bash

source "$(dirname "$0")/shelllog.sh"

dates=$(git log | grep Date | awk '{print " : "$4" "$3" "$6}')

if [ -z "$dates" ]; then
    error "No dates found in the git logs."
    exit 1
fi

sorted_dates=$(echo "$dates" | sort | uniq -c)

read sum count <<< $(echo "$sorted_dates" | awk '{ sum+=$1; count++ } END { print sum, count }')

if [ "$count" -eq 0 ]; then
    error "No unique dates to process."
    exit 1
fi

average=$(bc <<< "scale=2; $sum / $count")

log "The average number of commits per day (on days committed) is: $average"
