#!/bin/bash

set -e

if [ "$#" -lt 2 ]; then
    echo "Usage: $(basename ${0}) <output_format> <input_audio_file>"
    exit 1
fi

output_format="$1"
input_file="$2"

if [ ! -f "$input_file" ]; then
    echo "Error: Input file not found!"
    exit 1
fi

filename=$(basename -- "$input_file")
extension="${filename##*.}"
filename="${filename%.*}"

if [ "$output_format" == "mp3" ]; then
    conversion_tool="ffmpeg"
else
    conversion_tool="sox"
fi

case "$conversion_tool" in
    ffmpeg)
        ffmpeg -i "$input_file" -q:a 0 "${filename}.${output_format}"
        ;;
    sox)
        sox "$input_file" "${filename}.${output_format}"
        ;;
    *)
        echo "Error: Unexpected conversion tool!"
        exit 1
        ;;
esac

echo "Conversion complete: ${filename}.${output_format}"

